---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

### 1. Load Data
```{r}
act <- read.csv("activity.csv")
names(act)[1] <- "Steps"
names(act)[3] <- "Interval"
```
### 2. Process/Transform the data into a format suitab;e for your analysis
```{r{}}

install.packages("ggplot2")
library(ggplot2)
install.packages("dplyr")
library(dplyr)
install.packages("lattice")
library(lattice)
install.packages("tidyr")
library(tidyr)
install.packages("lubridate")
library(lubridate)
````
### Change Date format to column with date type
```{r}
act$date <- as.Date(act$date , format = "%Y-%m-%d")
```
### Create total steps per day
```{r}
act.day <- aggregate(act$steps, by =list (act$date), sum)
names(act.day)[1] <- "Date"
names(act.day)[2] <- "Steps"
```
### Create total steps per interval
```{r}
act.int <- aggregate(act$steps, by=list (act$interval), sum, na.rm=TRUE, na.action=NULL)
names(act.int)[1] <- "Interval"
names(act.int)[2] <- "Steps"
```
### Create dataframe with with mean steps per interval
```{r}
act.meanint <- aggregate(act$steps, by=list(act$interval), mean, na.rm=TRUE, na.action=NULL)
names(act.meanint)[1] <- "Interval"
names(act.meanint)[2] <- "MeanSteps"
```

## What is mean total number of steps taken per day?

### 1. Make a histogram of total number of steps taken each day (ignore missing values)
```{r echo=TRUE}
act.dayNA <- act.day[!is.na(act.day$Steps), ]

png("ACTday.png", width=480, height=480, bg="white")

hist(act.day$Steps, 
  main = "Total Number of Steps Take Each Day",
  xlab= "Total Number of Steps Taken")
  ylab= "Frequency"
  
  dev.off()
```
### 2. Calcutae and report the mean and median totla bumber of steps taken  
  
### Mean number of steps taken each day  
```{r echo=TRUE}
act.mean <- mean(act.day$Steps, na.rm=TRUE)
mean(act.mean)
```

### Median number of steps taken each day
```{r echo=TRUE}
act.median <- median(act.day$Steps, na.rm=TRUE)
median(act.median)
```

## What is the average daily activity pattern?

### 1. Make a Time Series Plot of Average Daily Actvity
```{r echo=TRUE}
png("AVEplot.png", width=480, height=480, bg="white")

plot(act.meanint)

dev.off()
```
### 2. which interval, on average across all the days contains the maximum number of steps

### Which Row and Mean Value
```{r echo=TRUE}
which.max( act.meanint[,2])
max(act.meanint[,2])



```
## Imputing missing values

#### 1. Calculate and report the total number of missing values in the dataset
```{r}
sum(!complete.cases(act))
```
### 2. Fill in the missing values in the dataset
```{r}

act.NA <- merge(act, act.meanint, by = "Interval", sort = FALSE)
## replace NA in Steps with MeanSteps value

act.NA$Steps <- ifelse(is.na(act.NA$Steps), act.NA$MeanSteps, act.NA$Steps)
act.NA$MeanSteps <- NULL
```
```{r echo=TRUE}

act.day2 <- aggregate(act.NA$Steps, by =list(act.NA$date), sum)
names(act.day2)[1] <- "Date"
names(act.day2)[2] <- "Steps"
```
### 4. Create a Histogram of Total Number of Steps per day
png("ACTday2.png", width=480, height=480, bg="white")

hist(act.day2$Steps, 
  main = "Total Number of Steps Take Each Day (NA replaced)",
  xlab= "Total Number of Steps Taken")
  ylab= "Frequency"
  
  dev.off()
```
#### 4.B Find Mean and Median total number of steps taken per day
``` {r echo=TRUE}
mean(act.day2$Steps)
median(act.day2$Steps)
```
## Are there differences in activity patterns between weekdays and weekends?
``` {r echo=TRUE}

act.day2$weekdayType <- ifelse(weekdays(act.day2$Date) %in% 
                                c("Saturday", "Sunday"), 
                                "weekend", "weekday")
head(act.week)

act.week <- function(date) {
    if (weekdays(as.Date(date)) %in% c("Saturday", "Sunday")) {
        "weekend"
    } else {
        "weekday"
    }
}
activity$act.week <- as.factor(sapply(act.week$date, act.week))


df$day <- weekdays(as.Date(df$date))
act.day2$day <- weekdays(as.Date(act.day2$Date))

act.week <- act.day2
