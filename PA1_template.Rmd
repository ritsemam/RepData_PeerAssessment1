---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

### 1. Load Data
```{r}
act <- read.csv("activity.csv")
names(act)[1] <- "Steps"
names(act)[3] <- "Interval"
```
### 2. Process/Transform the data into a format suitab;e for your analysis
```{r{}}

install.packages("ggplot2")
library(ggplot2)
install.packages("dplyr")
library(dplyr)
install.packages("lattice")
library(lattice)
install.packages("tidyr")
library(tidyr)
install.packages("lubridate")
library(lubridate)
````
### Change Date format to column with date type
```{r}
act$date <- as.Date(act$date , format = "%Y-%m-%d")
```
### Create total steps per day
```{r}
act.day <- aggregate(act$steps, by =list (act$date), sum)
names(act.day)[1] <- "Date"
names(act.day)[2] <- "Steps"
```
### Create total steps per interval
```{r}
act.int <- aggregate(act$steps, by=list (act$interval), sum, na.rm=TRUE, na.action=NULL)
names(act.int)[1] <- "Interval"
names(act.int)[2] <- "Steps"
```
### Create dataframe with with mean steps per interval
```{r}
act.meanint <- aggregate(act$steps, by=list(act$interval), mean, na.rm=TRUE, na.action=NULL)
names(act.meanint)[1] <- "Interval"
names(act.meanint)[2] <- "MeanSteps"
```

## What is mean total number of steps taken per day?

### 1. Make a histogram of total number of steps taken each day (ignore missing values)
```{r}
act.dayNA <- act.day[!is.na(act.day$Steps), ]

png("ACTday.png", width=480, height=480, bg="white")

hist(act.day$Steps, 
  main = "Total Number of Steps Take Each Day",
  xlab= "Total Number of Steps Taken")
  ylab= "Frequency"
  
  dev.off()
```
### 2. Calcutae and report the mean and median totla bumber of steps taken  
  
### Mean number of steps taken each day  
```{r}
act.mean <- mean(act.day$Steps, na.rm=TRUE)
mean(act.mean)
```

### Median number of steps taken each day
```{r}
act.median <- median(act.day$Steps, na.rm=TRUE)
median(act.median)
```

## What is the average daily activity pattern?

### 1. Make a Time Series Plot of Average Daily Actvity
```{r}
png("AVEplot.png", width=480, height=480, bg="white")

plot(act.meanint)

dev.off()
```
### 2. which interval, on average across all the days contains the maximum number of steps

### Which Row and Mean Value
```{r}
which.max( act.meanint[,2])
max(act.meanint[,2])



```
## Imputing missing values

#### 1. Calculate and report the total number of missing values in the dataset
```{r}
sum(!complete.cases(act))
```
### 2. Fill in the missing values in the dataset
```{r}

act.NA <- merge(act, act.meanint, by = "Interval", sort = FALSE)
## replace NA in Steps with MeanSteps value

act.NA$Steps <- ifelse(is.na(act.NA$Steps), act.NA$MeanSteps, act.NA$Steps)
act.NA$MeanSteps <- NULL

```


## Are there differences in activity patterns between weekdays and weekends?
